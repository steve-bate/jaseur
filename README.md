# Jaseur ActivityPub Server

<p align="center">
  <img src="jaseur.webp" width="300" alt="Jaseur">
</p>

Jaseur is an ActivityPub server implementation in C++ developed using AI agent technology. The name "Jaseur" comes from the French word meaning "chatterer" or "one who talks a lot," and is also the French name for the Waxwing bird family (Bombycilla), known for their sociable nature and constant trilling calls. This name symbolizes the server's role in facilitating communication and conversation in the federated social web, much like how Waxwings are known for their social behavior and communication within their flocks. True to its name, Jaseur enables seamless message exchange and interaction across the Fediverse through the ActivityPub protocol.

*Note: Even this README.md documentation is generated by AI agents, demonstrating the capabilities of AI assistance in software development.*

**⚠️ IMPORTANT: This implementation is NOT intended for production use. It is an experimental project to explore the capabilities of AI-assisted development. The AI-generated code in this project should NOT be trusted without thorough human review, as it may contain bugs, security vulnerabilities, or other issues. Use at your own risk.**

## Table of Contents

- [Description](#description)
- [Installation](#installation)
- [Configuration](#configuration)
  - [TOML Configuration File](#toml-configuration-file)
  - [Environment Variables](#environment-variables)
  - [Command-Line Arguments](#command-line-arguments)
- [Usage](#usage)
  - [Server Command](#server-command)
  - [Resource Management](#resource-management)
  - [Actor Management](#actor-management)
  - [Inbox/Outbox Management](#inboxoutbox-management)
- [Features](#features)
- [Testing](#testing)
- [License](#license)

## Description

Jaseur is a lightweight, extensible ActivityPub server that implements the core ActivityPub protocol for federated social networking. It provides a robust foundation for building decentralized social applications that participate in the Fediverse, interoperating with other ActivityPub-compatible platforms like Mastodon, Pleroma, and others through a single, standardized protocol.

What sets Jaseur apart is its integration with Large Language Models (LLMs) through Ollama, enabling AI-enhanced interactions and automated responses to ActivityPub activities.

## Installation

### Prerequisites

- C++17 compatible compiler (GCC 7+ or Clang 5+)
- CMake 3.10+
- OpenSSL
- Git (for fetching dependencies)

The build system automatically fetches and configures the following dependencies:
- nlohmann/json
- spdlog
- CLI11
- toml11
- GoogleTest (for testing)

### Building from Source

```bash
# Clone the repository
git clone https://github.com/yourusername/jaseur.git
cd jaseur

# Create build directory and compile
mkdir -p build && cd build
cmake ..
make
```

## Configuration

Jaseur uses a flexible configuration system that supports:

1. TOML configuration files
2. Environment variables
3. Command-line arguments

Configuration values are loaded in the following order, with later sources overriding earlier ones:

1. Default values in the code
2. `jaseur.toml` file in the current directory
3. Environment variables with the `JASEUR_` prefix
4. Command-line arguments

### TOML Configuration File

Create a `jaseur.toml` file in your working directory, or specify a different file with `--config`. See `jaseur.toml.example` for a complete example.

```toml
# Server settings
bind-address = "0.0.0.0"
port = 8000
debug = false
enable-llm = false

# Data settings
data = "data"
data.private = "data/private"

# Network settings
[network]
allow = ["127.0.0.1", "192.168.1.100"]  # As a TOML array

# Ollama settings
[ollama]
endpoint = "http://localhost:11434/api/generate"
model = "llama3:8B"
```

### Environment Variables

Environment variables are prefixed with `JASEUR_` and use underscores instead of dots:

```bash
export JASEUR_BIND_ADDRESS="0.0.0.0"
export JASEUR_PORT=8000
export JASEUR_DEBUG=true

# Data paths
export JASEUR_DATA="data"
export JASEUR_DATA_PRIVATE="data/private"

# Network allow list
export JASEUR_NETWORK_ALLOW="127.0.0.1,192.168.1.100"

# Ollama configuration for LLM integration
export JASEUR_OLLAMA_ENDPOINT="http://localhost:11434/api/generate"
export JASEUR_OLLAMA_MODEL="llama3:8B"
```

### Command-Line Arguments

Command-line arguments override both TOML and environment variables:

```bash
./jaseur serve --debug --port=9000 --ollama.model=llama3:70B
```

You can use dot notation for nested configuration values (e.g., `--ollama.model=llama3:70B`).

## Usage

Jaseur provides several command groups for managing different aspects of the ActivityPub server:

### Server Command

```bash
# Start the server
./jaseur serve

# Specify a custom configuration file
./jaseur serve --config=my-config.toml

# Override specific settings
./jaseur serve --port=9000 --debug --enable-llm
```

Server command options:
- `--config FILE`: Configuration file path (default: jaseur.toml)
- `--debug`: Enable debug logging
- `--enable-llm`: Enable LLM responder integration with Ollama
- `--bind-address ADDR`: Address to bind to (default: 0.0.0.0)
- `--port NUM`: Port to listen on (default: 8000)
- `--data DIR`: AP data directory (default: jaseur_data)
- `--data.private DIR`: Private key directory (default: jaseur_data/private)
- `--network.allow IPS`: Semicolon-separated list of allowed IP addresses
- `--ollama-endpoint URL`: Ollama API endpoint
- `--ollama-model MODEL`: Ollama model to use

### Resource Management

```bash
# Store a JSON file in the resource store
./jaseur resource put person.json jaseur_data

# Retrieve and display a resource
./jaseur resource get https://example.com/users/alice jaseur_data
./jaseur resource get https://example.com/users/alice jaseur_data --details

# List all resources
./jaseur resource list jaseur_data

# Get the hash for a URI
./jaseur resource hash-uri https://example.com/users/alice

# Post a note to an actor's outbox
./jaseur resource post --token=your_auth_token
```

### Actor Management

```bash
# Create a new actor
./jaseur actor create https://example.com/users/alice jaseur_data --name="Alice"

# List all actors
./jaseur actor list jaseur_data

# Remove an actor and all its resources
./jaseur actor purge https://example.com/users/alice jaseur_data
```

### Inbox/Outbox Management

```bash
# List inbox contents
./jaseur inbox list https://example.com/users/alice jaseur_data

# Clear inbox
./jaseur inbox purge https://example.com/users/alice jaseur_data

# List outbox contents
./jaseur outbox list https://example.com/users/alice jaseur_data

# Clear outbox
./jaseur outbox purge https://example.com/users/alice jaseur_data
```

## Features

- **URI-Independent Architecture**: The server doesn't depend on specific URI path structures for resource retrieval or POST operations, making future extensions for multi-tenant (multi-domain) support relatively easy
- **Abstracted Storage Layer**: While utilizing efficient file-based storage by default, the architecture employs a clean interface abstraction that enables seamless integration with alternative storage backends (databases, cloud storage, etc.) without modifying core application logic
- **ActivityPub Protocol Support**: Implements a subset of ActivityPub for server-to-server federation
- **Flexible Configuration**: TOML files, environment variables, and command-line arguments
- **Resource Management**: Tools for manipulating ActivityPub resources
- **Actor Management**: Create and manage ActivityPub actors
- **Inbox/Outbox Handling**: Process incoming and outgoing activities
- **WebFinger Support**: Actor discovery through WebFinger
- **LLM Integration**: Connect to Ollama for AI-enhanced interactions
- **Security Features**: IP filtering and authentication
- **Comprehensive Logging**: Detailed logs for troubleshooting

## Testing

The project includes a comprehensive test suite using GoogleTest:

```bash
# Build and run tests
cd build
make test

# Or run the test executable directly for more detailed output
./jaseur_tests
```

## License

This project is licensed under the MIT License - see the LICENSE file for details.